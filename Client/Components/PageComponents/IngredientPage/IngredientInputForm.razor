@using BlazingRecept.Client.Components.PageComponents.Base
@using BlazingRecept.Client.Components.Utilities;
@using BlazingRecept.Client.Utilities;
@using BlazingRecept.Shared.Dto

@inherits PageComponentBase

<PageTitle>Ingredients</PageTitle>

<div class="card mb-2">
    <div class="card-body">
        <CollapsibleComponent CollapsedButtonText="Show ingredient form" ExposedButtonText="Hide ingredient form">
            <EditForm Model="_form" OnValidSubmit="@HandleValidFormSubmitted">
                <CustomValidation @ref="_customValidation" />
                <div class="form-floating mb-2">
                    <input type="text" id="name" name="name" class="form-control" @bind="_form.Name" @onblur="@(_ => HandleNameBlur())" placeholder="Name">
                    <label for="name">Name</label>
                    <ValidationMessage For="() => _form.Name" />
                </div>
                <div class="form-floating mb-2">
                    <input type="text" id="fat" name="fat" class="form-control" @bind="_form.Fat" placeholder="Fat">
                    <label for="fat">Fat</label>
                    <ValidationMessage For="() => _form.Fat" />
                </div>
                <div class="form-floating mb-2">
                    <input type="text" id="carbohydrates" name="carbohydrates" class="form-control" @bind="_form.Carbohydrates" placeholder="Carbohydrates">
                    <label for="carbohydrates">Carbohydrates</label>
                    <ValidationMessage For="() => _form.Carbohydrates" />
                </div>
                <div class="form-floating mb-2">
                    <input type="text" id="protein" name="protein" class="form-control" @bind="_form.Protein" placeholder="Protein">
                    <label for="protein">Protein</label>
                    <ValidationMessage For="() => _form.Protein" />
                </div>
                <div class="form-floating mb-2">
                    <input type="text" id="calories" name="calories" class="form-control" @bind="_form.Calories" placeholder="Calories">
                    <label for="calories">Calories</label>
                    <ValidationMessage For="() => _form.Calories" />
                </div>
                <div class="form-group mb-2">
                    <InputSelect id="category-selector" name="category-selector" class="form-select" @bind-Value="_form.CategoryDtoId">
                        <option value="@Guid.Empty">Choose a category...</option>
                        @if (_categoryDtos != null)
                        {
                            foreach (CategoryDto categoryDto in _categoryDtos)
                            {
                                <option value="@categoryDto.Id">@categoryDto.Name</option>
                            }
                        }
                    </InputSelect>
                    <ValidationMessage For="() => _form.CategoryDtoId" />
                </div>
                <button class="btn btn-primary" type="submit">Add ingredient</button>
            </EditForm>
        </CollapsibleComponent>
    </div>
</div>
